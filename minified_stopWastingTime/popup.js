function applyOverlay(url){let blockPageURL=chrome.runtime.getURL('block-page.html');let optionsPageURL=chrome.runtime.getURL('options.html');let extensionsURL="chrome://extensions/";if(url==blockPageURL||url==optionsPageURL||url==extensionsURL){document.getElementById('overlay').style.display='block';}else{document.getElementById('overlay').style.display='none';}}
chrome.tabs.query({'active':true,'lastFocusedWindow':true},function(tabs){let url=tabs[0].url;applyOverlay(url);});chrome.storage.sync.get('mode',function(data){let currentMode=data.mode;let blockMode=document.getElementById('block-mode');let limitMode=document.getElementById('limit-mode');if(currentMode==='BLOCK'){blockMode.style.backgroundColor='rgb(255, 90, 90)';blockMode.style.color='white';}else if(currentMode==='LIMIT'){limitMode.style.backgroundColor='rgb(90, 90, 255)';limitMode.style.color='white';}});function setPopupUrl(tabs){let tab=tabs[0];let url=new URL(tab.url);let domain=url.hostname;document.getElementById('url-textbox').setAttribute('value',domain);}
chrome.tabs.query({'active':true,'lastFocusedWindow':true},setPopupUrl);function addToList(listName){chrome.storage.sync.get(listName,function(data){debugger;let updateList=data[listName];let domain=document.getElementById('url-textbox').value;updateList.push(domain);let updateObject={};updateObject[listName]=updateList;chrome.storage.sync.set(updateObject,()=>{console.log(`${domain}added to ${listName}`);});});}
function toggleMode(modePressed){chrome.storage.sync.get('mode',function(data){let changeMode=null;if(data.mode!==modePressed){changeMode=modePressed;}
chrome.storage.sync.set({'mode':changeMode},()=>{console.log(`${changeMode}mode set`);let blockMode=document.getElementById('block-mode');let limitMode=document.getElementById('limit-mode');if(changeMode===null){blockMode.style.backgroundColor='white';blockMode.style.color='rgb(255, 90, 90)';limitMode.style.backgroundColor='white';limitMode.style.color='rgb(90, 90, 255)';}else if(changeMode==='BLOCK'){blockMode.style.backgroundColor='rgb(255, 90, 90)';blockMode.style.color='white';limitMode.style.backgroundColor='white';limitMode.style.color='rgb(90, 90, 255)';}else if(changeMode==='LIMIT'){blockMode.style.backgroundColor='white';blockMode.style.color='rgb(255, 90, 90)';limitMode.style.backgroundColor='rgb(90, 90, 255)';limitMode.style.color='white';}});});}
let blockButton=document.getElementById('block-button');blockButton.addEventListener('click',function(){addToList('blockList');});let limitButton=document.getElementById('limit-button');limitButton.addEventListener('click',function(){addToList('limitList');});let blockModeButton=document.getElementById('block-mode');blockModeButton.addEventListener('click',function(){toggleMode('BLOCK');});let limitModeButton=document.getElementById('limit-mode');limitModeButton.addEventListener('click',function(){toggleMode('LIMIT');});let settingsButton=document.getElementById('settings');settingsButton.addEventListener('click',function(){chrome.runtime.openOptionsPage();});